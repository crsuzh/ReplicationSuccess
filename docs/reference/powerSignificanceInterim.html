<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Interim power of a replication study — powerSignificanceInterim • ReplicationSuccess</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Interim power of a replication study — powerSignificanceInterim"><meta property="og:description" content="Computes the power of a replication study taking into account data from an interim analysis."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ReplicationSuccess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/crsuzh/ReplicationSuccess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Interim power of a replication study</h1>
    <small class="dont-index">Source: <a href="https://github.com/crsuzh/ReplicationSuccess/blob/HEAD/R/powerSignificanceInterim.R" class="external-link"><code>R/powerSignificanceInterim.R</code></a></small>
    <div class="hidden name"><code>powerSignificanceInterim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the power of a replication study taking into account data from an interim analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span></span>
<span>  <span class="va">zo</span>,</span>
<span>  <span class="va">zi</span>,</span>
<span>  c <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  designPrior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"conditional"</span>, <span class="st">"informed predictive"</span>, <span class="st">"predictive"</span><span class="op">)</span>,</span>
<span>  analysisPrior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"flat"</span>, <span class="st">"original"</span><span class="op">)</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one.sided"</span>, <span class="st">"two.sided"</span><span class="op">)</span>,</span>
<span>  shrinkage <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>zo</dt>
<dd><p>Numeric vector of z-values from original studies.</p></dd>


<dt>zi</dt>
<dd><p>Numeric vector of z-values from interim analyses of replication studies.</p></dd>


<dt>c</dt>
<dd><p>Numeric vector of variance ratios of the original and replication effect estimates.
This is usually the ratio of the sample size of the replication study to the sample
size of the original study. Default is 1.</p></dd>


<dt>f</dt>
<dd><p>Fraction of the replication study already completed. Default is 0.5.</p></dd>


<dt>level</dt>
<dd><p>Significance level. Default is 0.025.</p></dd>


<dt>designPrior</dt>
<dd><p>Either "conditional" (default), "informed predictive", or "predictive".
"informed predictive" refers to an informative normal prior coming from the original study.
"predictive" refers to a flat prior.</p></dd>


<dt>analysisPrior</dt>
<dd><p>Either "flat" (default) or "original".</p></dd>


<dt>alternative</dt>
<dd><p>Either "one.sided" (default) or "two.sided".
Specifies if the significance level is one-sided or two-sided.</p></dd>


<dt>shrinkage</dt>
<dd><p>Numeric vector with values in [0,1). Defaults to 0.
Specifies the shrinkage of the original effect estimate towards zero, e.g.,
the effect is shrunken by a factor of 25% for <code>shrinkage=0.25</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>The probability of statistical significance in the specified direction
at the end of the replication study given the data collected so far
in the replication study.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This is an extension of <code><a href="powerSignificance.html">powerSignificance()</a></code> and adapts the `interim power'
from section 6.6.3 of Spiegelhalter et al. (2004) to the setting of replication studies.</p>
<p><code>powerSignificanceInterim</code> is the vectorized version of
 <code>.powerSignificanceInterim_</code>.
<code><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></code> is used to vectorize the function.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Spiegelhalter, D. J., Abrams, K. R., and Myles, J. P. (2004).
Bayesian Approaches to Clinical Trials and Health-Care
Evaluation, volume 13. John Wiley &amp; Sons</p>
<p>Micheloud, C., Held, L. (2022). Power Calculations for Replication Studies.
<em>Statistical Science</em>, <b>37</b>, 369-379.
<a href="https://doi.org/10.1214/21-STS828" class="external-link">doi:10.1214/21-STS828</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sampleSizeSignificance.html">sampleSizeSignificance</a></code>, <code><a href="powerSignificance.html">powerSignificance</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Charlotte Micheloud</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span>, f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         designPrior <span class="op">=</span> <span class="st">"conditional"</span>,</span></span>
<span class="r-in"><span>                         analysisPrior <span class="op">=</span> <span class="st">"flat"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7396952</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span>, f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         designPrior <span class="op">=</span> <span class="st">"informed predictive"</span>,</span></span>
<span class="r-in"><span>                         analysisPrior <span class="op">=</span> <span class="st">"flat"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7659095</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span>, f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         designPrior <span class="op">=</span> <span class="st">"predictive"</span>,</span></span>
<span class="r-in"><span>                         analysisPrior <span class="op">=</span> <span class="st">"flat"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8074296</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span>, f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         designPrior <span class="op">=</span> <span class="st">"conditional"</span>,</span></span>
<span class="r-in"><span>                         analysisPrior <span class="op">=</span> <span class="st">"flat"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0003931199</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">powerSignificanceInterim</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">1</span>, f <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>                         designPrior <span class="op">=</span> <span class="st">"conditional"</span>,</span></span>
<span class="r-in"><span>                         analysisPrior <span class="op">=</span> <span class="st">"flat"</span>,</span></span>
<span class="r-in"><span>                         shrinkage <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6136529</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leonhard Held, Samuel Pawel, Charlotte Micheloud, Florian Gerber, Felix Hofmann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

