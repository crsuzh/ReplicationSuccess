<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Computes the sceptical p-value and z-value — pSceptical • ReplicationSuccess</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Computes the sceptical p-value and z-value — pSceptical"><meta property="og:description" content="Computes sceptical p-values and z-values based on the z-values of the
original and the replication study and the corresponding variance ratios.
If specified, the sceptical p-values are recalibrated."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ReplicationSuccess</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/crsuzh/ReplicationSuccess/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Computes the sceptical p-value and z-value</h1>
    <small class="dont-index">Source: <a href="https://github.com/crsuzh/ReplicationSuccess/blob/HEAD/R/pSceptical.R" class="external-link"><code>R/pSceptical.R</code></a></small>
    <div class="hidden name"><code>pSceptical.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes sceptical p-values and z-values based on the z-values of the
original and the replication study and the corresponding variance ratios.
If specified, the sceptical p-values are recalibrated.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pSceptical</span><span class="op">(</span></span>
<span>  <span class="va">zo</span>,</span>
<span>  <span class="va">zr</span>,</span>
<span>  <span class="va">c</span>,</span>
<span>  alternative <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"one.sided"</span>, <span class="st">"two.sided"</span><span class="op">)</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"golden"</span>, <span class="st">"nominal"</span>, <span class="st">"controlled"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zSceptical</span><span class="op">(</span><span class="va">zo</span>, <span class="va">zr</span>, <span class="va">c</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>zo</dt>
<dd><p>Numeric vector of z-values from original studies.</p></dd>


<dt>zr</dt>
<dd><p>Numeric vector of z-values from replication studies.</p></dd>


<dt>c</dt>
<dd><p>Numeric vector of variance ratios of the original and replication
effect estimates. This is usually the ratio of the sample
size of the replication study to the sample size of the
original study.</p></dd>


<dt>alternative</dt>
<dd><p>Either "one.sided" (default) or "two.sided".
If "one.sided", the sceptical p-value is based on a one-sided
assessment of replication success in the direction of the original effect
estimate. If "two.sided", the sceptical p-value is based on a two-sided
assessment of replication success regardless of the direction of the
original and replication effect estimate.</p></dd>


<dt>type</dt>
<dd><p>Type of recalibration. Can be either "golden" (default),
"nominal", or "controlled". Setting <code>type</code> to "nominal" corresponds
to no recalibration as in Held et al. (2020). A recalibration is applied if
<code>type</code> is  "controlled", or "golden", and the sceptical p-value
can then be interpreted on the same scale as an ordinary
p-value (e.g., a one-sided
sceptical p-value can be thresholded at the conventional 0.025 level).
"golden" ensures that
for an original study just significant at the specified <code>level</code>,
replication success is only possible if the replication effect estimate is at
least as large as the original one.
"controlled" ensures exact overall Type-I error control at
level <code>level</code>^2.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>pSceptical</code> returns the sceptical p-value.</p>


<p><code>zSceptical</code> returns the z-value of the sceptical p-value.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p><code>pSceptical</code> is the vectorized version of
the internal function <code>.pSceptical_</code>.
<code><a href="https://rdrr.io/r/base/Vectorize.html" class="external-link">Vectorize</a></code> is used to vectorize the function.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Held, L. (2020). A new standard for the analysis and design of replication
studies (with discussion). <em>Journal of the Royal Statistical Society:
Series A (Statistics in Society)</em>, <b>183</b>, 431-448.
<a href="https://doi.org/10.1111/rssa.12493" class="external-link">doi:10.1111/rssa.12493</a></p>

<p>Held, L., Micheloud, C., Pawel, S. (2022). The assessment of replication
    success based on relative effect size. <em>The Annals of Applied
    Statistics</em>. 16:706-720. <a href="https://doi.org/10.1214/21-AOAS1502" class="external-link">doi:10.1214/21-AOAS1502</a></p>
<p>Micheloud, C., Balabdaoui, F., Held, L. (2023). Assessing replicability
with the sceptical p-value: Type-I error control and
sample size planning. <em>Statistica Neerlandica</em>. <a href="https://doi.org/10.1111/stan.12312" class="external-link">doi:10.1111/stan.12312</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="sampleSizeReplicationSuccess.html">sampleSizeReplicationSuccess</a></code>,
    <code><a href="powerReplicationSuccess.html">powerReplicationSuccess</a></code>, <code><a href="levelSceptical.html">levelSceptical</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Leonhard Held</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## no recalibration (type = "nominal") as in Held (2020)</span></span></span>
<span class="r-in"><span><span class="fu">pSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, zr <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, c <span class="op">=</span> <span class="fl">2</span>, alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span></span>
<span class="r-in"><span>           type <span class="op">=</span> <span class="st">"nominal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.05790852</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## recalibration with golden level as in Held, Micheloud, Pawel (2020)</span></span></span>
<span class="r-in"><span><span class="fu">pSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, zr <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, c <span class="op">=</span> <span class="fl">2</span>, alternative <span class="op">=</span> <span class="st">"one.sided"</span>,</span></span>
<span class="r-in"><span>           type <span class="op">=</span> <span class="st">"golden"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02273138</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## two-sided p-values 0.01 and 0.02, relative sample size 2</span></span></span>
<span class="r-in"><span><span class="fu">pSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, zr <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>, c <span class="op">=</span> <span class="fl">2</span>, alternative <span class="op">=</span> <span class="st">"one.sided"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.02273138</span>
<span class="r-in"><span><span class="co">## reverse the studies</span></span></span>
<span class="r-in"><span><span class="fu">pSceptical</span><span class="op">(</span></span></span>
<span class="r-in"><span>  zo <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.02</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  zr <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  c <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,</span></span>
<span class="r-in"><span>  alternative <span class="op">=</span> <span class="st">"one.sided"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.008786301</span>
<span class="r-in"><span><span class="co">## both p-values 0.01, relative sample size 2</span></span></span>
<span class="r-in"><span><span class="fu">pSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, zr <span class="op">=</span> <span class="fu"><a href="conversionHelpers.html">p2z</a></span><span class="op">(</span><span class="fl">0.01</span><span class="op">)</span>, c <span class="op">=</span> <span class="fl">2</span>, alternative <span class="op">=</span> <span class="st">"two.sided"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03496702</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">zSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">2</span>, zr <span class="op">=</span> <span class="fl">3</span>, c <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.531634</span>
<span class="r-in"><span><span class="fu">zSceptical</span><span class="op">(</span>zo <span class="op">=</span> <span class="fl">3</span>, zr <span class="op">=</span> <span class="fl">2</span>, c <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.531634</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Leonhard Held, Samuel Pawel, Charlotte Micheloud, Florian Gerber, Felix Hofmann.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

